"0","hold_out <- function(data, k){"
"0","  #Installing Caret Package"
"0","  library(caret)"
"0","  accuracy_list2 = c()"
"0","  for (i in 1:15){"
"0","    set.seed(j*10)"
"0","    #Data Partitioning"
"0","    trainIndices <- createDataPartition(y = data$class, p=k, list = FALSE)"
"0","    #trainIndices = sample(1:nrow(ecoli),nrow(ecoli)*0.8)"
"0","    trainset <- data[trainIndices, ]"
"0","    testset <- data[-trainIndices, ]"
"0","    "
"0","  #Naive Bayes Classifier"
"0","    # Installing e1071"
"0","    library(e1071)"
"0","    # Applying Naive Bayes"
"0","    nbc <- naiveBayes(class ~., data =trainset )"
"0","    # Making predictions"
"0","    prediction2 <- predict(nbc, testset, type=""class"")"
"0","    #cm2 <- table(testset$class, prediction2, dnn = c(""Real Values"", ""Predictions""))"
"0","    #Calculating Accuracy"
"0","    #n2 = diag(cm2)"
"0","    #accuracy2 <- sum(n2)/sum(cm2)"
"0","    #accuracy_list2[j] = accuracy2"
"0","    count<- 0"
"0","    for(j in 1:length(prediction2)){"
"0","      if(prediction2[j]==testset$class[j]){"
"0","        count = count + 1"
"0","      }"
"0","    }"
"0","    res <- count/length(prediction2)"
"0","    accuracy_list2[i] = res"
"0","  }"
"0","  a2 = sum(accuracy_list2)/15"
"0","  return(a2)"
"0","}"
